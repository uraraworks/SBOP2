# 2024-04-15 Wave 1 詳細設計ワークショップ議事録

- 作成者: QA (CCCC)
- 更新日: 2024-04-15
- レビュワー: Dev (YYYY), Ops (BBBB)

## 1. 参加者と確認事項
- 出席者: XXXX, YYYY, ZZZZ, AAAA, BBBB, CCCC
- 開始前確認: 目的・スコープ・アジェンダを了承。録画と議事録の共有可否を確認し、全員同意。

## 2. 決定事項
1. **サーバー情報ダッシュボード**
   - `/api/server` で `includeMetrics=true` のときのみ CPU/メモリ/レイテンシを返却する。
   - キャッシュ層は 30 秒の TTL。`CMgrData` 障害時は 503 を返却し、UI は退避メッセージを表示。
2. **アカウント作成**
   - `/api/accounts` のパスワードポリシー: 12文字以上、英大文字/小文字/数字/記号の 3 種類以上を必須。
   - 既存アカウントとの重複チェックは `loginId` と `email` で実施。
3. **ロール設定**
   - `/api/admin/roles` の PUT は冪等。リクエスト履歴を監査ログに出力し、`comment` を必須ではなく任意入力とする。
4. **監査・運用**
   - 監査ログの Kinesis 連携は Wave 2 で対応。Wave 1 では DB への格納のみ。
   - フェイルバック時は MFC 管理ツールを再開する手順を Runbook に追記する。

## 3. 宿題事項
- [ ] Ops: 監査ログの保持期間（90日 vs 180日）についてセキュリティチームと調整。
- [x] Dev: `/api/admin/roles` の排他制約パターン（`ROLE_UPDATE` vs `ACCOUNT_LOCK`) を定義。
  - Wave 1 では `SERVER_ADMIN` ロールを単一アカウントに制限し、2 件目以降は 409 (`conflictRole=SERVER_ADMIN`) を返す方針で合意。
- [ ] QA: アカウント作成のバリデーションパターンテストケースを洗い出し、テストサマリーに追記。

## 4. リスク・懸念
- UI チームのキャパシティが逼迫しており、ワイヤーフレームのビジュアルレビューが遅延する可能性。
- パスワードポリシー変更に伴う CS チームへの FAQ 更新が必要。担当者未アサイン。

## 5. 次回アクション
- 2024-04-18: Dev/QA 合同レビューで API スキーマのドラフトチェック。
- 2024-04-22: Ops との運用手順レビュー会。
- 2024-04-26: Wave 1 実装スプリント開始。

以上。
