/* Copyright(C)URARA-works 2005 */
/* ========================================================================= */
/* ファイル名	:GetMD5.cpp													 */
/* 内容			:MD5計算クラス 実装ファイル									 */
/* 作成			:年がら年中春うらら(URARA-works)							 */
/* 作成開始日	:2005/04/06													 */
/* ========================================================================= */

#include "StdAfx.h"
#include <cstdio>
#include "GetMD5.h"

/* ========================================================================= */
/* 関数名	:CGetMD5::CGetMD5												 */
/* 内容		:コンストラクタ													 */
/* 日付		:2005/04/06														 */
/* ========================================================================= */

CGetMD5::CGetMD5()
{
	Init ();
}


/* ========================================================================= */
/* 関数名	:CGetMD5::~CGetMD5												 */
/* 内容		:デストラクタ													 */
/* 日付		:2005/04/06														 */
/* ========================================================================= */

CGetMD5::~CGetMD5()
{
}


/* ========================================================================= */
/* 関数名	:CGetMD5::Init													 */
/* 内容		:初期化															 */
/* 日付		:2005/04/06														 */
/* ========================================================================= */

void CGetMD5::Init(void)
{
	MD5Init (&m_stContext);
}


/* ========================================================================= */
/* 関数名	:CGetMD5::Update												 */
/* 内容		:更新															 */
/* 日付		:2005/04/06														 */
/* ========================================================================= */

void CGetMD5::Update(
	PBYTE pSrc,			/* [in] 計算したいバッファ */
	DWORD dwSize)		/* [in] バッファサイズ */
{
	MD5Update (&m_stContext, pSrc, dwSize);
}


/* ========================================================================= */
/* 関数名	:CGetMD5::GetBin												 */
/* 内容		:取得(バイナリ)													 */
/* 日付		:2005/04/06														 */
/* ========================================================================= */

void CGetMD5::GetBin(
	PBYTE pDst)		/* [ou] 計算された値(16バイト) */
{
	MD5Final (pDst, &m_stContext);
	Init ();
}


/* ========================================================================= */
/* 関数名	:CGetMD5::GetStr												 */
/* 内容		:取得(文字列)													 */
/* 日付		:2005/04/06														 */
/* ========================================================================= */

void CGetMD5::GetStr(
	LPSTR pszDst)		/* [ou] 計算された値(33バイト) */
{
	int i;
	BYTE aTmp[16];

	MD5Final (aTmp, &m_stContext);

       for (i = 0; i < 16; i ++) {
               sprintf_s (&pszDst[i * 2], 3, "%02X", aTmp[i]);
       }
}

/* Copyright(C)URARA-works 2005 */
